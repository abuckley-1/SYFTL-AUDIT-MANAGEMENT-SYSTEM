<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Audit Entry | Sentinel AMS</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-brand"><h2>Sentinel</h2></div>
            <nav class="nav-menu">
                <a href="index.html" class="nav-link">ðŸ“Š Dashboard</a>
                <a href="audit-plan.html" class="nav-link">ðŸ“… Audit Schedules</a>
            </nav>
        </aside>

        <main class="main-content">
            <div class="card" style="background:white; padding:30px; border-radius:10px;">
                <h2 id="formTitle">Loading Questionnaire...</h2>
                <p id="phaseIndicator" style="font-weight:bold; color:var(--st-orange);"></p>
                <hr>
                <form id="activeForm">
                    <div id="questionArea">
                        </div>
                    
                    <div style="margin-top:30px;">
                        <button type="button" class="btn-primary" onclick="saveProgress()">ðŸ’¾ Save Progress</button>
                        <button type="button" class="btn-secondary" onclick="submitFinal()">âœ… Final Submission</button>
                    </div>
                </form>
            </div>
        </main>
    </div>

    <script>
        // Check day of month to decide Phase
        const day = new Date().getDate();
        const phase = day <= 14 ? "INITIAL" : "EVIDENCE";
        
        document.getElementById('formTitle').innerText = "Audit Questionnaire (ST0096)";
        document.getElementById('phaseIndicator').innerText = phase === "INITIAL" ? 
            "PHASE 1: Initial Assessment (Weeks 1-2)" : 
            "PHASE 2: Further Evidence Gathering (Weeks 3-4)";

        const questionArea = document.getElementById('questionArea');

        if(phase === "INITIAL") {
            questionArea.innerHTML = `
                <label>Q1: Are COSHH assessments available for all substances in your area?</label>
                <select id="q1"><option>Select...</option><option>Yes</option><option>No</option></select>
                <br><br>
                <label>Initial Comments:</label>
                <textarea id="comments" style="width:100%; height:100px;"></textarea>
            `;
        } else {
            questionArea.innerHTML = `
                <label>Evidence Upload: Please provide SYPOL screenshots or training logs.</label>
                <input type="file" multiple>
                <br><br>
                <label>Detailed Evidence Notes:</label>
                <textarea id="evidenceNotes" style="width:100%; height:100px;"></textarea>
            `;
        }

        function saveProgress() {
            alert("Progress saved locally. You can return to complete this before the phase deadline.");
            // Logic to save to localStorage
            const data = { q1: document.getElementById('q1')?.value, notes: document.getElementById('comments')?.value };
            localStorage.setItem('audit_draft', JSON.stringify(data));
        }

        function submitFinal() {
            if(confirm("Confirm final submission? No further edits can be made.")) {
                window.location.href = "index.html";
            }
        }
    </script>
</body>
</html>
